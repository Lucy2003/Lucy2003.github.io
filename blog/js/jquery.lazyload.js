!function(i,a,r,f){var l=i(a);i.fn.lazyload=function(t){var o=this,n={threshold:0,failure_limit:0,event:"scroll",effect:"show",container:a,data_attribute:"original",skip_invisible:!1,appear:null,load:null,placeholder:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsQAAA7EAZUrDhsAAAANSURBVBhXYzh8+PB/AAffA0nNPuCLAAAAAElFTkSuQmCC"};function e(){var e=0;o.each(function(){var t=i(this);if((!n.skip_invisible||t.is(":visible"))&&!i.abovethetop(this,n)&&!i.leftofbegin(this,n))if(i.belowthefold(this,n)||i.rightoffold(this,n)){if(++e>n.failure_limit)return!1}else t.trigger("appear"),e=0})}return t&&(f!==t.failurelimit&&(t.failure_limit=t.failurelimit,delete t.failurelimit),f!==t.effectspeed&&(t.effect_speed=t.effectspeed,delete t.effectspeed),i.extend(n,t)),t=n.container===f||n.container===a?l:i(n.container),0===n.event.indexOf("scroll")&&t.bind(n.event,e),this.each(function(){var e=this,r=i(e);e.loaded=!1,r.attr("src")!==f&&!1!==r.attr("src")||r.is("img")&&r.attr("src",n.placeholder),r.one("appear",function(){var t;this.loaded||(n.appear&&(t=o.length,n.appear.call(e,t,n)),i("<img />").bind("load",function(){var t=r.attr("data-"+n.data_attribute);r.hide(),r.is("img")?r.attr("src",t):r.css("background-image","url('"+t+"')"),r[n.effect](n.effect_speed),e.loaded=!0;t=i.grep(o,function(t){return!t.loaded});o=i(t),n.load&&(t=o.length,n.load.call(e,t,n))}).attr("src",r.attr("data-"+n.data_attribute)).on("error",function(){r.attr("src",r.attr("errorImg")),r.attr("alt",r.attr("alt")+" - 图像加载失败");var t=r.parent("a.fancybox").attr("SecondHref");r.parent("a.fancybox").attr("href",t)}))}),0!==n.event.indexOf("scroll")&&r.bind(n.event,function(){e.loaded||r.trigger("appear")})}),l.bind("resize",function(){e()}),/(?:iphone|ipod|ipad).*os 5/gi.test(navigator.appVersion)&&l.bind("pageshow",function(t){t.originalEvent&&t.originalEvent.persisted&&o.each(function(){i(this).trigger("appear")})}),i(r).ready(function(){e()}),this},i.belowthefold=function(t,e){var r=e.container===f||e.container===a?(a.innerHeight?a.innerHeight:l.height())+l.scrollTop():i(e.container).offset().top+i(e.container).height();return r<=i(t).offset().top-e.threshold},i.rightoffold=function(t,e){var r=e.container===f||e.container===a?l.width()+l.scrollLeft():i(e.container).offset().left+i(e.container).width();return r<=i(t).offset().left-e.threshold},i.abovethetop=function(t,e){var r=e.container===f||e.container===a?l.scrollTop():i(e.container).offset().top;return r>=i(t).offset().top+e.threshold+i(t).height()},i.leftofbegin=function(t,e){var r=e.container===f||e.container===a?l.scrollLeft():i(e.container).offset().left;return r>=i(t).offset().left+e.threshold+i(t).width()},i.inviewport=function(t,e){return!(i.rightoffold(t,e)||i.leftofbegin(t,e)||i.belowthefold(t,e)||i.abovethetop(t,e))},i.extend(i.expr[":"],{"below-the-fold":function(t){return i.belowthefold(t,{threshold:0})},"above-the-top":function(t){return!i.belowthefold(t,{threshold:0})},"right-of-screen":function(t){return i.rightoffold(t,{threshold:0})},"left-of-screen":function(t){return!i.rightoffold(t,{threshold:0})},"in-viewport":function(t){return i.inviewport(t,{threshold:0})},"above-the-fold":function(t){return!i.belowthefold(t,{threshold:0})},"right-of-fold":function(t){return i.rightoffold(t,{threshold:0})},"left-of-fold":function(t){return!i.rightoffold(t,{threshold:0})}})}(jQuery,window,document);